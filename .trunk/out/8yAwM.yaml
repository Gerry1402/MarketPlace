trunk_cli_version: 1.22.15
title: osv-scanner exited with exit_code=1
report:
  - osv-scanner exited with exit_code=1
  - linter:
      command: |
        'C:\Users\Cesar\AppData\Local\trunk\tools\osv-scanner\2.0.2-7f223bce81cb208c2024f8e19a30f3df\osv-scanner.exe' --lockfile=package-lock.json --format json
      stdin_path: (none)
      run_from: C:\Users\Cesar\AppData\Local\Temp\trunk\rvlw62u\
      timeout: 10m
      rerun: (cd C:\Users\Cesar\AppData\Local\Temp\trunk\rvlw62u\; env -i 'PATH=C:\Users\Cesar\AppData\Local\trunk\tools\osv-scanner\2.0.2-7f223bce81cb208c2024f8e19a30f3df;C:/Users/Cesar/AppData/Local/trunk/tools/git-bash/2.40.1-da0c3e1526d36e62bf43d06ec46c5052/bin;C:/Users/Cesar/AppData/Local/trunk/tools/git-bash/2.40.1-da0c3e1526d36e62bf43d06ec46c5052/usr/bin;C:\Users\Cesar\AppData\Local\trunk\tools\osv-scanner\2.0.2-7f223bce81cb208c2024f8e19a30f3df;C:\Users\Cesar\AppData\Local\trunk\tools\git-bash\2.40.1-da0c3e1526d36e62bf43d06ec46c5052/bin;C:\Users\Cesar\AppData\Local\trunk\tools\git-bash\2.40.1-da0c3e1526d36e62bf43d06ec46c5052/usr/bin;C:\Program Files (x86)\VMware\VMware Player\bin\;C:\Program Files\Common Files\Oracle\Java\javapath;C:\Program Files (x86)\Common Files\Oracle\Java\javapath;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Windows\System32\OpenSSH\;C:\Program Files\AutoFirma\AutoFirma;C:\Program Files\NVIDIA Corporation\NVIDIA NvDLISR;C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;C:\Program Files\dotnet\;C:\Program Files\Git\cmd;C:\Program Files\nodejs\;C:\Users\Cesar\AppData\Local\Programs\Python\Python311\Scripts\;C:\Users\Cesar\AppData\Local\Programs\Python\Python311\;C:\Users\Cesar\AppData\Local\Microsoft\WindowsApps;C:\Users\Cesar\AppData\Local\Programs\Microsoft VS Code\bin;C:\Users\Cesar\AppData\Local\GitHubDesktop\bin;C:\Users\Cesar\AppData\Roaming\npm' 'C:\Users\Cesar\AppData\Local\trunk\tools\osv-scanner\2.0.2-7f223bce81cb208c2024f8e19a30f3df\osv-scanner.exe' --lockfile=package-lock.json --format json)
      affects_cache:
        []
      direct_configs:
        []
      exit_status: exited
      exit_code: 1
      stdout: |
        {
          "results": [
            {
              "source": {
                "path": "C:/Users/Cesar/AppData/Local/Temp/trunk/rvlw62u/package-lock.json",
                "type": "lockfile"
              },
              "packages": [
                {
                  "package": {
                    "name": "vite",
                    "version": "6.3.3",
                    "ecosystem": "npm"
                  },
                  "dependency_groups": [
                    "dev"
                  ],
                  "vulnerabilities": [
                    {
                      "modified": "2025-05-02T15:33:47Z",
                      "published": "2025-04-30T17:40:27Z",
                      "schema_version": "1.6.0",
                      "id": "GHSA-859w-5945-r5v3",
                      "aliases": [
                        "CVE-2025-46565"
                      ],
                      "summary": "Vite's server.fs.deny bypassed with /. for files under project root",
                      "details": "### Summary\nThe contents of files in [the project `root`](https://vite.dev/config/shared-options.html#root) that are denied by a file matching pattern can be returned to the browser.\n\n### Impact\n\nOnly apps explicitly exposing the Vite dev server to the network (using --host or [server.host config option](https://vitejs.dev/config/server-options.html#server-host)) are affected.\nOnly files that are under [project `root`](https://vite.dev/config/shared-options.html#root) and are denied by a file matching pattern can be bypassed.\n\n- Examples of file matching patterns: `.env`, `.env.*`, `*.{crt,pem}`, `**/.env`\n- Examples of other patterns: `**/.git/**`, `.git/**`, `.git/**/*`\n\n### Details\n[`server.fs.deny`](https://vite.dev/config/server-options.html#server-fs-deny) can contain patterns matching against files (by default it includes `.env`, `.env.*`, `*.{crt,pem}` as such patterns).\nThese patterns were able to bypass for files under `root` by using a combination of slash and dot (`/.`).\n\n### PoC\n```\nnpm create vite@latest\ncd vite-project/\ncat \"secret\" \u003e .env\nnpm install\nnpm run dev\ncurl --request-target /.env/. http://localhost:5173\n```\n\n![image](https://github.com/user-attachments/assets/822f4416-aa42-461f-8c95-a88d155e674b)\n![image](https://github.com/user-attachments/assets/42902144-863a-4afb-ac5b-fc16effa37cc)",
                      "severity": [
                        {
                          "type": "CVSS_V4",
                          "score": "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N"
                        }
                      ],
                      "affected": [
                        {
                          "package": {
                            "ecosystem": "npm",
                            "name": "vite",
                            "purl": "pkg:npm/vite"
                          },
                          "ranges": [
                            {
                              "type": "SEMVER",
                              "events": [
                                {
                                  "introduced": "6.3.0"
                                },
                                {
                                  "fixed": "6.3.4"
                                }
                              ]
                            }
                          ],
                          "database_specific": {
                            "last_known_affected_version_range": "\u003c= 6.3.3",
                            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-859w-5945-r5v3/GHSA-859w-5945-r5v3.json"
                          }
                        },
                        {
                          "package": {
                            "ecosystem": "npm",
                            "name": "vite",
                            "purl": "pkg:npm/vite"
                          },
                          "ranges": [
                            {
                              "type": "SEMVER",
                              "events": [
                                {
                                  "introduced": "6.2.0"
                                },
                                {
                                  "fixed": "6.2.7"
                                }
                              ]
                            }
                          ],
                          "database_specific": {
                            "last_known_affected_version_range": "\u003c= 6.2.6",
                            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-859w-5945-r5v3/GHSA-859w-5945-r5v3.json"
                          }
                        },
                        {
                          "package": {
                            "ecosystem": "npm",
                            "name": "vite",
                            "purl": "pkg:npm/vite"
                          },
                          "ranges": [
                            {
                              "type": "SEMVER",
                              "events": [
                                {
                                  "introduced": "6.0.0"
                                },
                                {
                                  "fixed": "6.1.6"
                                }
                              ]
                            }
                          ],
                          "database_specific": {
                            "last_known_affected_version_range": "\u003c= 6.1.5",
                            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-859w-5945-r5v3/GHSA-859w-5945-r5v3.json"
                          }
                        },
                        {
                          "package": {
                            "ecosystem": "npm",
                            "name": "vite",
                            "purl": "pkg:npm/vite"
                          },
                          "ranges": [
                            {
                              "type": "SEMVER",
                              "events": [
                                {
                                  "introduced": "5.0.0"
                                },
                                {
                                  "fixed": "5.4.19"
                                }
                              ]
                            }
                          ],
                          "database_specific": {
                            "last_known_affected_version_range": "\u003c= 5.4.18",
                            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-859w-5945-r5v3/GHSA-859w-5945-r5v3.json"
                          }
                        },
                        {
                          "package": {
                            "ecosystem": "npm",
                            "name": "vite",
                            "purl": "pkg:npm/vite"
                          },
                          "ranges": [
                            {
                              "type": "SEMVER",
                              "events": [
                                {
                                  "introduced": "0"
                                },
                                {
                                  "fixed": "4.5.14"
                                }
                              ]
                            }
                          ],
                          "database_specific": {
                            "last_known_affected_version_range": "\u003c= 4.5.13",
                            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/04/GHSA-859w-5945-r5v3/GHSA-859w-5945-r5v3.json"
                          }
                        }
                      ],
                      "references": [
                        {
                          "type": "WEB",
                          "url": "https://github.com/vitejs/vite/security/advisories/GHSA-859w-5945-r5v3"
                        },
                        {
                          "type": "ADVISORY",
                          "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-46565"
                        },
                        {
                          "type": "WEB",
                          "url": "https://github.com/vitejs/vite/commit/c22c43de612eebb6c182dd67850c24e4fab8cacb"
                        },
                        {
                          "type": "PACKAGE",
                          "url": "https://github.com/vitejs/vite"
                        }
                      ],
                      "database_specific": {
                        "cwe_ids": [
                          "CWE-22"
                        ],
                        "github_reviewed": true,
                        "github_reviewed_at": "2025-04-30T17:40:27Z",
                        "nvd_published_at": "2025-05-01T18:15:57Z",
                        "severity": "MODERATE"
                      }
                    }
                  ],
                  "groups": [
                    {
                      "ids": [
                        "GHSA-859w-5945-r5v3"
                      ],
                      "aliases": [
                        "CVE-2025-46565",
                        "GHSA-859w-5945-r5v3"
                      ],
                      "max_severity": "6.0"
                    }
                  ]
                }
              ]
            }
          ],
          "experimental_config": {
            "licenses": {
              "summary": false,
              "allowlist": null
            }
          }
        }

      stderr: |
        Scanned C:\Users\Cesar\AppData\Local\Temp\trunk\rvlw62u\package-lock.json file and found 339 packages

    parser:
      command: |
        'C:\Users\Cesar\AppData\Local\trunk\tools\python\3.10.8-2211cb108575de2785d77a26a1f8d070\python3.exe' C:/Users/Cesar/AppData/Local/trunk/plugins/https---github-com-trunk-io-plugins/v1.6.8-4ebadccd80b22638/linters/osv-scanner/osv_to_sarif.py
      stdin_path: (none)
      run_from: C:\Users\Cesar\AppData\Local\Temp\trunk\rvlw62u\
      timeout: 10m
      rerun: (cd C:\Users\Cesar\AppData\Local\Temp\trunk\rvlw62u\; env -i 'Path=C:\Program Files (x86)\VMware\VMware Player\bin\;C:\Program Files\Common Files\Oracle\Java\javapath;C:\Program Files (x86)\Common Files\Oracle\Java\javapath;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Windows\System32\OpenSSH\;C:\Program Files\AutoFirma\AutoFirma;C:\Program Files\NVIDIA Corporation\NVIDIA NvDLISR;C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;C:\Program Files\dotnet\;C:\Program Files\Git\cmd;C:\Program Files\nodejs\;C:\Users\Cesar\AppData\Local\Programs\Python\Python311\Scripts\;C:\Users\Cesar\AppData\Local\Programs\Python\Python311\;C:\Users\Cesar\AppData\Local\Microsoft\WindowsApps;C:\Users\Cesar\AppData\Local\Programs\Microsoft VS Code\bin;C:\Users\Cesar\AppData\Local\GitHubDesktop\bin;C:\Users\Cesar\AppData\Roaming\npm' PYTHONUTF8=1 'VIRTUAL_ENV=C:\Users\Cesar\AppData\Local\trunk\tools\osv-scanner\2.0.2-7f223bce81cb208c2024f8e19a30f3df' 'SYSTEMROOT=C:\Windows' 'PATH=C:\Users\Cesar\AppData\Local\trunk\tools\osv-scanner\2.0.2-7f223bce81cb208c2024f8e19a30f3df;C:\Users\Cesar\AppData\Local\trunk\tools\git-bash\2.40.1-da0c3e1526d36e62bf43d06ec46c5052/bin;C:\Users\Cesar\AppData\Local\trunk\tools\git-bash\2.40.1-da0c3e1526d36e62bf43d06ec46c5052/usr/bin;C:\Users\Cesar\AppData\Local\trunk\tools\osv-scanner\2.0.2-7f223bce81cb208c2024f8e19a30f3df/bin;C:\Users\Cesar\AppData\Local\trunk\tools\osv-scanner\2.0.2-7f223bce81cb208c2024f8e19a30f3df/Scripts;C:\Users\Cesar\AppData\Local\trunk\tools\python\3.10.8-2211cb108575de2785d77a26a1f8d070/bin;C:\Users\Cesar\AppData\Local\trunk\tools\python\3.10.8-2211cb108575de2785d77a26a1f8d070;C:\Users\Cesar\AppData\Local\trunk\tools\osv-scanner\2.0.2-7f223bce81cb208c2024f8e19a30f3df;C:\Users\Cesar\AppData\Local\trunk\tools\git-bash\2.40.1-da0c3e1526d36e62bf43d06ec46c5052/bin;C:\Users\Cesar\AppData\Local\trunk\tools\git-bash\2.40.1-da0c3e1526d36e62bf43d06ec46c5052/usr/bin;C:\Program Files (x86)\VMware\VMware Player\bin\;C:\Program Files\Common Files\Oracle\Java\javapath;C:\Program Files (x86)\Common Files\Oracle\Java\javapath;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Windows\System32\OpenSSH\;C:\Program Files\AutoFirma\AutoFirma;C:\Program Files\NVIDIA Corporation\NVIDIA NvDLISR;C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;C:\Program Files\dotnet\;C:\Program Files\Git\cmd;C:\Program Files\nodejs\;C:\Users\Cesar\AppData\Local\Programs\Python\Python311\Scripts\;C:\Users\Cesar\AppData\Local\Programs\Python\Python311\;C:\Users\Cesar\AppData\Local\Microsoft\WindowsApps;C:\Users\Cesar\AppData\Local\Programs\Microsoft VS Code\bin;C:\Users\Cesar\AppData\Local\GitHubDesktop\bin;C:\Users\Cesar\AppData\Roaming\npm' HOME= 'HOMEPATH=\Users\Cesar' 'SystemRoot=C:\Windows' 'windir=C:\Windows' 'APPDATA=C:\Users\Cesar\AppData\Roaming' 'LOCALAPPDATA=C:\Users\Cesar\AppData\Local' 'USERPROFILE=C:\Users\Cesar' 'TMP=C:\Users\Cesar\AppData\Local\Temp' 'TEMP=C:\Users\Cesar\AppData\Local\Temp' 'C:\Users\Cesar\AppData\Local\trunk\tools\python\3.10.8-2211cb108575de2785d77a26a1f8d070\python3.exe' C:/Users/Cesar/AppData/Local/trunk/plugins/https---github-com-trunk-io-plugins/v1.6.8-4ebadccd80b22638/linters/osv-scanner/osv_to_sarif.py)
      exit_status: exited
      exit_code: 2
      stdout: (none)
      stderr: |
        C:\Users\Cesar\AppData\Local\trunk\tools\python\3.10.8-2211cb108575de2785d77a26a1f8d070\python3.exe: can't open file 'C:\\Users\\Cesar\\AppData\\Local\\trunk\\plugins\\https---github-com-trunk-io-plugins\\v1.6.8-4ebadccd80b22638\\linters\\osv-scanner\\osv_to_sarif.py': [Errno 2] No such file or directory

